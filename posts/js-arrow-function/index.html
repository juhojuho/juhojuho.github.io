<!doctype html>
<html lang="en">
  <head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XL2F2ZJSGS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-XL2F2ZJSGS');
  </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[JS] Arrow Function</title>
    <meta name="description" content="ES6를 한 번이라도 접해본 사람이라면 Arrow Function을 알고 있을 것이다. Arrow Function은 코드의 수를 획기적으로 줄이고 가독성을 높인다. 단순히 문법적 편리성 뿐만 아니라 `this`의 용법도 달라진다. 이번 포스트에서 자세히 알아보자.">
    <meta name="google-site-verification" content="l1HzNpcuiOpfuOSg2r-oNIA3H7Csyir1J6Ndxn58yBg" />
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prim-dracula.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="햄스터 갬성 블로그">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="햄스터 갬성 블로그">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/">햄스터 갬성 블로그</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/">Home</a></li>
      <li class="nav-item"><a href="https://docs.google.com/document/d/1ck-8cwrlvLPKVGgOVjYlFC1veIgsGonSiA0-aTXiXoo/edit?usp=sharing" target="_blank">About</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>[JS] Arrow Function</h1>

<p>ES6를 한 번이라도 접해본 사람이라면 Arrow Function을 알고 있을 것이다. Arrow Function은 코드의 수를 획기적으로 줄이고 가독성을 높인다. 단순히 문법적 편리성 뿐만 아니라 <code>this</code>의 용법도 달라진다. 이번 포스트에서 자세히 알아보자.</p>
<p>본격적으로 들어가기 전에 간단한 퀴즈 2개를 풀어보자.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Quiz1</span><br><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">a</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br>foo<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// What's the output?</span><br> <br><span class="token comment">// Quiz2</span><br><span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br>bar<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// What's the output?</span><br></code></pre>
<p><code>foo.a()</code>와 <code>bar.b()</code>의 출력값은 무엇일까? 만약 첫 번째 문제의 답을 <code>a</code>로 구했다면 이 포스트를 읽기 전에 <code>this</code>의 용법을 다시 공부하길 추천한다. <code>foo.a()</code>는 <code>foo</code>를 출력한다. 두 번째 문제는 다소 어렵다. 만약 답을 맞힌다면 이 포스트를 읽지 않고 건너뛰어도 무방하다. 당신은 이미 Arrow Function을 마스터했다! 아마 <code>bar.b()</code>의 출력값을 <code>bar</code>로 예상했겠지만, 답은 <code>window</code>이다. 굉장히 놀랍지 않나! 이제부터 왜 그런지 Arrow Function에 하나씩 대해 알아보자.</p>
<h2 id="%EB%84%98%EB%82%98-%ED%8E%B8%EB%A6%AC%ED%95%9C-%EA%B2%83">넘나 편리한 것 <a class="direct-link" href="#%EB%84%98%EB%82%98-%ED%8E%B8%EB%A6%AC%ED%95%9C-%EA%B2%83">#</a></h2>
<p>가끔 자바스크립트를 쓰다 보면 간단한 로직을 위해 생각보다 많은 코드를 쓸 때가 있다.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br> <br><span class="token comment">// Before ES6</span><br>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// ES6</span><br>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span></code></pre>
<p>배열의 모든 값을 2배 하는 간단한 코드다. 위와 아래 중 어떤 코드가 더 읽기 편한가. 물론 워낙 짧은 코드라서 둘 다 가독성이 좋다. 하지만 코드의 양이 많아질수록 syntatic sugar는 큰 도움이 된다. Arrow Function도 그런 면에서 함수를 정의하는 기존의 <code>function</code> 키워드의 대체재로써 ES6에 새로 추가되었다. Arrow Function을 쓰면 훨씬 간단하게 함수를 표현할 수 있다.</p>
<h2 id="%EB%B3%B8%EA%B2%A9%EC%A0%81%EC%9C%BC%EB%A1%9C-arrow-function-%ED%99%9C%EC%9A%A9%ED%95%98%EA%B8%B0">본격적으로 Arrow Function 활용하기 <a class="direct-link" href="#%EB%B3%B8%EA%B2%A9%EC%A0%81%EC%9C%BC%EB%A1%9C-arrow-function-%ED%99%9C%EC%9A%A9%ED%95%98%EA%B8%B0">#</a></h2>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">names</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">'Harry'</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> <span class="token function-variable function">square</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> x <span class="token operator">*</span> x<span class="token punctuation">;</span><br><span class="token keyword">var</span> <span class="token function-variable function">nothing</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>x <span class="token operator">+</span> y<span class="token punctuation">}</span><br><span class="token keyword">var</span> <span class="token function-variable function">printAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br> <br><span class="token function">names</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// "Harry"</span><br><span class="token function">square</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// 25</span><br><span class="token function">nothing</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span><br><span class="token function">printAll</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span> <span class="token comment">// logs a, b, c</span></code></pre>
<p>Arrow Function은 <code>function</code> 키워드가 필요 없고 특정 조건에서 <code>return</code>이나 <code>{ }</code> 중괄호까지 생략할 수 있다. 단지 <code>=&gt;</code> 키워드만 필요하다. <code>=&gt;</code> 앞에는 매개변수가 있고 뒤에 함수의 본문이 위치한다.</p>
<p>매개변수는 기존의 방식처럼 <code>( )</code> 소괄호로 감싸면 된다. 단, 매개변수가 하나면 괄호를 생략해도 된다. 매개변수가 없거나 하나 이상이면 괄호가 필요하다.</p>
<p>body는 이전처럼 <code>{ }</code> 중괄호로 감싸면 된다. 단, body가 단 한 줄이면 생략할 수 있다. 여기서 조심해야 할 점이 있다. 중괄호를 생략하면 자동으로 <code>return</code>이 body에 삽입된다. 위 코드에서 <code>square</code> 함수가 그 예다. <code>return</code>이 없는 데도 <code>25</code>가 반환되었다. 따라서 어떤 값도 함수에서 반환하고 싶지 않으면 body가 한 줄이어도 중괄호를 생략하면 안 된다. 그 예로 위에서 <code>nothing</code> 함수는 중괄호를 삽입해 <code>25</code>가 아닌 <code>undefined</code>를 반환한다.</p>
<h2 id="%EC%9D%B4%EC%A0%9C%EB%B6%80%ED%84%B0-%EB%8D%94-%EC%A4%91%EC%9A%94%ED%95%B4">이제부터 더 중요해 <a class="direct-link" href="#%EC%9D%B4%EC%A0%9C%EB%B6%80%ED%84%B0-%EB%8D%94-%EC%A4%91%EC%9A%94%ED%95%B4">#</a></h2>
<p>Arrow Function의 역할은 단순히 코드 길이를 줄이는 게 아니다. Arrow Function을 사용하면 <code>this</code>의 용법이 달라진다.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br>foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// logs window</span></code></pre>
<p>보통 <code>this</code>는 동적으로 정해진다. run-time에 결정되므로 코드만 봐서는 <code>this</code>가 어떤 값일지 모른다. 어떤 문맥(context)에서 <code>this</code>가 호출되는지 잘 살펴봐야 한다. 위 예처럼 callback function은 window가 호출하므로 <code>this</code>는 window를 가리킨다.</p>
<p>하지만 Arrow function을 사용하면 <code>this</code>가 정적으로 정해진다. 그래서 코드만 잘 살펴봐도 <code>this</code>에 어떤 값이 들어갈지 쉽게 유추할 수 있다. Arrow function에서 <code>this</code>는 한 단계 밖 scope의 <code>this</code>와 일치한다. 쉽게 말하면 <code>this</code>를 평범한 변수 취급하라는 얘기다. 즉, <code>this</code>를 Arrow Function 내부에는 존재하지 않는 변수여서 한 단계 위의 <code>this</code>를 가져온다고 생각하면 편하다. 마치 아래 코드에서 변수 <code>a</code>가 하듯이 말이다.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">"Hello World!"</span><span class="token punctuation">;</span><br>    <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br> <br><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// logs "Hello World!"</span></code></pre>
<p>함수 <code>bar</code> 내부에 변수 <code>a</code>가 존재하지 않아 자바스크립트 엔진은 한 단계 위 scope(이 경우 함수 <code>foo</code>)에서 <code>a</code>가 있는지 찾는다. 따라서 함수 <code>foo</code> 내부의 <code>a</code>가 출력된다. Arrow Function 속에 있는 <code>this</code>는 변수 <code>a</code>와 비슷하게 작동한다. 이제 실제 예를 보며 <code>this</code> 찾기를 연습해보자.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br> <br>foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// logs foo</span></code></pre>
<p>위의 코드에서 <code>console.log(this)</code>의 한 단계 밖 scope는 <code>bar</code>이다. 즉, Arrow function의 내부에서 <code>this</code>는 <code>bar</code>에서의 <code>this</code>와 일치한다. <code>bar</code>에서 <code>this</code>는 <code>foo</code>를 가리키므로 Arrow function 내부에서 <code>this</code>도 <code>foo</code>를 가리킨다.</p>
<p>혹시 이해가 가지 않는다면 아래의 코드를 참고하자. 위의 코드를 그대로 풀어쓰면 아래의 코드가 나온다.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span><br>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br> <br>foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//logs foo</span></code></pre>
<p>위 코드는 우리가 흔히 callback function에서 <code>this</code>를 정의할 때 주로 쓰는 패턴이다. callback function을 누가 호출할지 예측할 수 없으므로 우린 <code>this</code>에 직접 값을 대입해준다. 이 경우 <code>bar</code>의 <code>this</code>를 변수 <code>self</code>에 담아 callback function으로 전해줬다. Arrow Function가 <code>var self = this;</code>를 대체한다고 생각하면 편한다.</p>
<p>이제 맨 위의 퀴즈도 자연스레 풀 수 있을 것이다.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Quiz2</span><br><span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token punctuation">{</span><br>    <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span> <br> <br>bar<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// logs window</span></code></pre>
<p><code>console.log(this)</code>가 속한 Arrow function의 한 단계 밖 함수는 <code>b</code>이다. <code>b</code>에서 <code>this</code>는 window(global object)를 가리킨다. 따라서 <code>console.log(this)</code>의 <code>this</code>도 window를 가리키게 된다.</p>
<p>이런 <code>this</code>의 의미를 변화를 이해하지 않으면 우리가 의도했던 바와 다르게 프로그램이 동작할 수 있다. Arrow Function은 결코 문법적 편리성만 제공하지 않는다! 바뀌는 <code>this</code>의 용법 반드시 이해하자.</p>
<p>매번 느끼는 거지만 아는 것을 말로 풀어내기는 참 힘들다. 특히 코딩 관련 지식을 글로 풀어내긴 더 힘든 것 같다. 이번 포스트는 내가 봐도 독자가 이해하기 어려울 것 같다(ㅠ_ㅠ). 혹시 이해 가지 않은 부분이 있으면 꼭 댓글로 달아주길 바란다. 그 부분에 대해 더 자세히 설명해 주겠다.</p>


<hr>
<ul><li>Next: <a href="/posts/new-language-translation/">[번역] 새로운 언어를 배우는 &#39;흔치 않은&#39; 방법</a></li><li>Previous: <a href="/posts/hexo-tip/">hexo 기반 블로그에 꿀기능 추가하기</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /posts/js-arrow-function/ -->
  </body>
</html>
