<!doctype html>
<html lang="en">
  <head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177518541-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-177518541-1');
</script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[JS] Map &amp; Set</title>
    <meta name="description" content="어떤 프로그래밍 언어로 개발하던 Map은 유용하게 사용된다. 옆 동네 Python에서 Map을 쓰는 빈도를 봐도 알 수 있다. 하지만 안타깝게도 Map은 ES6 전까지 자바스크립트에 존재하지 않았다. 대신 Object에 몇 가지 꼼수를 부리며 그 빈자리를 달랠 뿐이었다.">
    <meta name="google-site-verification" content="l1HzNpcuiOpfuOSg2r-oNIA3H7Csyir1J6Ndxn58yBg" />
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/prim-dracula.css">
    <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="햄스터 갬성 블로그">
    <link rel="alternate" href="/feed/feed.json" type="application/json" title="햄스터 갬성 블로그">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/">햄스터 갬성 블로그</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/">Home</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>[JS] Map &amp; Set</h1>

<p>어떤 프로그래밍 언어로 개발하던 Map은 유용하게 사용된다. 옆 동네 Python에서 Map을 쓰는 빈도를 봐도 알 수 있다. 하지만 안타깝게도 Map은 ES6 전까지 자바스크립트에 존재하지 않았다. 대신 Object에 몇 가지 꼼수를 부리며 그 빈자리를 달랠 뿐이었다. <em>보통 Object에 연결된 prototype을 제거하기 위해 <code>Object.create(null)</code>을 이용한다. 만약 평범한 Object를 사용했다면 주렁주렁 달려 있는 property 때문에 Map에 key 삽입시 충돌이 일어날 수도 있다.</em> 이번 포스트에서는 ES6에 새롭게 추가된 데이터 구조 Map에 대해 알아보자.</p>
<h2 id="google-map-%ED%95%A0-%EB%95%8C-%EA%B7%B8-map%3F">Google Map 할 때 그 Map? <a class="direct-link" href="#google-map-%ED%95%A0-%EB%95%8C-%EA%B7%B8-map%3F">#</a></h2>
<p>Map은 Object와 비슷하게 key와 value를 쌍으로 저장한다. 이때, key는 중복되지 않는다. 만약 이미 저장된 key가 또 들어오면 기존 value를 새 값으로 덮어쓴다. <code>set(key, value)</code> 함수로 key와 value를 저장하고 <code>get(key)</code>로 그 key와 연결된 value를 반환한다. 그리고 <code>new Map()</code>으로 Map을 생성한다. <code>new</code>를 쓰는 거로 보아 Map의 타입이 Object임을 알 수 있다. 마지막으로 삭제는 <code>delete(key)</code>로 하며 <code>clear()</code>로 모든 key, value 쌍을 지운다. 아래 코드에 기본적인 Map 사용법이 나와 있다.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> myMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br><span class="token keyword">typeof</span> myMap <span class="token comment">// "object"</span><br> <br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'Tom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'Sam'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Sam"</span><br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 15</span><br><br>myMap<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token comment">// true</span><br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span><br><br>myMap<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span></code></pre>
<h2 id="map%EA%B3%BC-object">Map과 Object <a class="direct-link" href="#map%EA%B3%BC-object">#</a></h2>
<p>여기까지 보면 Map은 Object와 상당히 유사하다. 그렇다면 왜 Map이 필요한 걸까? Map이 Object보다 나은 몇 가지 이유를 살펴보자.</p>
<p>Object의 key는 반드시 String이거나 Symbol이다. <a href="https://juhojuho.github.io/posts/js-symbol/">앞선 포스트</a>에서 봤듯이 ES6에서 새로 추가된 타입인 Symbol은 Object의 key로 사용될 수 있다. 반면에 Map의 key는 모든 타입을 허용한다. Number, Boolean은 물론이고 Object까지 가능하다. 즉, Object에 포함되는 function이나 array도 key로 사용할 수 있다.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> myMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br><span class="token keyword">var</span> keyString <span class="token operator">=</span> <span class="token string">'string key'</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> keyObject <span class="token operator">=</span> <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'object key'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> <span class="token function-variable function">keyFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">'function key'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token keyword">var</span> keySymbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'symbol key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>keyString<span class="token punctuation">,</span> <span class="token string">'I am a string key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>keyObject<span class="token punctuation">,</span> <span class="token string">'I am a object key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>keyFunction <span class="token punctuation">,</span> <span class="token string">'I am a function key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>keySymbol<span class="token punctuation">,</span> <span class="token string">'I am a symbol key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyString<span class="token punctuation">)</span> <span class="token comment">// "I am a string key"</span><br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyObject<span class="token punctuation">)</span> <span class="token comment">// "I am a object key"</span><br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyFunction<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "I am a function key"</span><br>myMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keySymbol<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "I am a symbol key"</span></code></pre>
<p>위 코드처럼 모든 타입이 Map의 key로 사용될 수 있다.</p>
<p>사소하지만 꽤 강력한 차이점이 하나 더 있다. Object는 크기를 구하는 built-in(이미 구현된) method나 property가 없다. <code>Object.keys(object).length</code>가 그나마 쉬운 방법이다. 하지만 time complexity가 linear하므로 Object가 커질수록 더 많은 시간이 소요된다. 반면에 Map은 <code>size</code> property로 크기를 단번에 구할 수 있다. 이 경우 <code>size</code> property가 수시로 갱신되므로 Map의 크기가 커져도 걸리는 시간에 영향을 주지 않는다.</p>
<pre class="language-js"><code class="language-js">myMap<span class="token punctuation">.</span>size <span class="token comment">// 4</span></code></pre>
<h2 id="map-%EA%B0%80%EC%A7%80%EA%B3%A0-%EC%A7%80%EC%A7%80%EA%B3%A0-%EB%B3%B6%EA%B8%B0">Map 가지고 지지고 볶기 <a class="direct-link" href="#map-%EA%B0%80%EC%A7%80%EA%B3%A0-%EC%A7%80%EC%A7%80%EA%B3%A0-%EB%B3%B6%EA%B8%B0">#</a></h2>
<p>Map에 저장된 key와 value를 쭉 늘여놓고 싶으면 <code>values()</code>와 <code>keys()</code> 함수를 사용하면 된다. 단, 이 두 함수는 iterator를 반환한다. 따라서 추가적인 작업이 들어가야 예쁘게 표현될 수 있다. 지금 단계에서 iterator를 몰라도 괜찮다. 다음 포스트에서 다룰 예정이다. 이제 아래 코드를 보자.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">var</span> myMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>myMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br>myMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// MapIterator {1, 2, 3}</span><br> <br><span class="token punctuation">[</span> <span class="token operator">...</span>myMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3]</span><br>Array<span class="token punctuation">.</span><span class="token function">from</span> <span class="token punctuation">(</span> myMap<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3]</span></code></pre>
<p><code>values()</code> 함수를 사용하면 Map에 저장된 모든 value가 iterator로 반환된다. iterator를 푸는 가장 원초적인 방법은 <code>for</code>문을 쓰는 것이다. 하지만 훨씬 더 손쉬운 방법이 ES6에 존재한다. Spread operator <code>...</code> 와 새로운 Array API <code>from()</code>을 쓰면 iterator를 array로 변환시킬 수 있다. 하지만 이 부분은 이번 포스트의 범위를 넘어가므로 다음에 다루겠다. 지금은 <code>values()</code>가 value의 iterator를 반환하고 이를 푸는 새로운 방법이 ES6에 등장했다는 정도만 알고 있자. <code>keys()</code>는 key의 iterator를 반환하며 나머지는 <code>values()</code>와 비슷하게 작용한다.</p>
<p><strong>Reference</strong><br>
<a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Map">Map - JavaScript | MDN</a><br>
<a href="https://hacks.mozilla.org/2015/06/es6-in-depth-collections/">ES6 In Depth: Collections</a><br>
<a href="https://github.com/getify/You-Dont-Know-JS/blob/master/es6%20%26%20beyond/ch5.md">You Don't Know JS: ES6 &amp; Beyond</a></p>


<hr>
<ul><li>Next: <a href="/posts/js-set/">[JS] Set</a></li><li>Previous: <a href="/posts/js-symbol/">[JS] Symbol</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /posts/js-map/ -->
  </body>
</html>
